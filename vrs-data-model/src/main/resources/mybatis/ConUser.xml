<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mastery.dao.IUserDao" > 
<!-- Result Map-->
<resultMap id="BaseResultMap" type="User" >
	<result column="id" property="id"/>
	<result column="username" property="username"/>
	<result column="fullname" property="fullname"/>
	<result column="password" property="password"/>
</resultMap>
       
<!-- con_user table all fields -->
<sql id="Base_Column_List" >
	 id,username,fullname,password
</sql>
   
<!-- 查询条件 -->
<sql id="Example_Where_Clause">
where 1=1
<trim  suffixOverrides="," >
	<if test="id != null  ">
		and id=#{id}
	</if>
	<if test="username != null  and username != ''   ">
		and username=#{username}
	</if>
	<if test="fullname != null  and fullname != ''   ">
		and fullname=#{fullname}
	</if>
	<if test="baseStart != null and baseSize != null "> 
	 limit #{baseStart}, #{baseSize} 
	</if>
</trim>
</sql>
   

<!-- 插入记录 -->
<insert id="insert" parameterType="User" >
  insert into con_user(username,fullname,password)
 values(#{username},#{fullname},#{password})
  <selectKey keyProperty="id" resultType="long" order="AFTER">
    select LAST_INSERT_ID() 
   </selectKey> 
</insert>

<!-- 根据id，修改记录-->  
 <update id="update" parameterType="User" >
  update con_user set username=#{username},fullname=#{fullname},password=#{password} where id=#{id}
 </update>
 


<!-- 逻辑删除，将deleted 改成 1 -->
<update id="delete" parameterType="User">
	delete form con_user where id = #{id}
</update>
 
<!-- 列表 -->
<select id="selectById"  resultMap="BaseResultMap" parameterType="java.lang.Long">
	select <include refid="Base_Column_List" /> 
	 from con_user where ID = #{id}
</select>
  	
<!--  列表总数-->
<select id="selectByModelCount" resultType="java.lang.Integer"  parameterType="User">
	select count(1) from con_user 
	<include refid="Example_Where_Clause"/>
</select>
  	
<!-- 根据id查询 -->
<select id="selectByModel" resultMap="BaseResultMap"  parameterType="User">
	select 
	<include refid="Base_Column_List"/>
	from con_user 
	<include refid="Example_Where_Clause"/>
	
</select>


<!--  列表总数-->
<select id="selectByMapCount" resultType="java.lang.Integer"  parameterType="java.util.Map">
	select count(1) from con_user 
	<include refid="Example_Where_Clause"/>
</select>
  	
<!-- 根据id查询 -->
<select id="selectByMap" resultMap="BaseResultMap"  parameterType="java.util.Map">
	select 
	<include refid="Base_Column_List"/>
	from con_user 
	<include refid="Example_Where_Clause"/>
    
</select>

<!-- 根据sql查询 -->
<select id="selectByBuilder" resultMap="BaseResultMap" parameterType="com.mastery.dao.sql.object.SelectSql">
	 SELECT ${selectCondition}
	FROM con_user
	<if test="whereCondition != null and whereCondition != '' "> 
	WHERE ${whereCondition}
	</if>
	<if test="orderByCondition != null  and orderByCondition != '' "> 
	ORDER BY ${orderByCondition}
	</if>
	<if test="limitCondition != null  and limitCondition != '' "> 
	 LIMIT ${limitCondition}
	</if>
</select>

<!-- 根据sql查询列表总数-->
<select id="selectCountByBuilder" resultType="java.lang.Integer" parameterType="com.mastery.dao.sql.object.SelectSql">
	 SELECT count(*)
	FROM con_user
	<if test="whereCondition != null and whereCondition != '' "> 
	WHERE ${whereCondition}
	</if>
</select>
  	
</mapper>   
